{"ast":null,"code":"\"use strict\"; // Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.LinkFlow = void 0;\n\nconst preact_1 = require(\"preact\");\n\nconst rxjs_1 = require(\"rxjs\");\n\nconst operators_1 = require(\"rxjs/operators\");\n\nconst LinkDialog_1 = require(\"./LinkDialog\");\n\nconst TryExtensionLinkDialog_1 = require(\"./TryExtensionLinkDialog\");\n\nclass LinkFlow {\n  constructor(options) {\n    this.extensionUI$ = new rxjs_1.BehaviorSubject({});\n    this.subscriptions = new rxjs_1.Subscription();\n    this.isConnected = false;\n    this.isOpen = false;\n    this.onCancel = null;\n    this.root = null; // if true, hide QR code in LinkFlow (which happens if no jsonRpcUrl is provided)\n\n    this.connectDisabled = false;\n    this.darkMode = options.darkMode;\n    this.version = options.version;\n    this.sessionId = options.sessionId;\n    this.sessionSecret = options.sessionSecret;\n    this.walletLinkUrl = options.walletLinkUrl;\n    this.isParentConnection = options.isParentConnection;\n    this.connected$ = options.connected$; // Check if extension UI is enabled\n\n    fetch(\"https://api.wallet.coinbase.com/rpc/v2/getFeatureFlags\").then(res => res.json()).then(json => {\n      const enabled = json.result.desktop.extension_ui;\n\n      if (typeof enabled === \"undefined\") {\n        this.extensionUI$.next({\n          value: false\n        });\n      } else {\n        this.extensionUI$.next({\n          value: enabled\n        });\n      }\n    }).catch(err => {\n      console.error('Couldn\\'t fetch feature flags - ', err);\n      this.extensionUI$.next({\n        value: false\n      });\n    });\n  }\n\n  attach(el) {\n    this.root = document.createElement(\"div\");\n    this.root.className = \"-walletlink-link-flow-root\";\n    el.appendChild(this.root);\n    this.render();\n    this.subscriptions.add(this.connected$.subscribe(v => {\n      if (this.isConnected !== v) {\n        this.isConnected = v;\n        this.render();\n      }\n    }));\n  }\n\n  detach() {\n    var _a;\n\n    if (!this.root) {\n      return;\n    }\n\n    this.subscriptions.unsubscribe();\n    (0, preact_1.render)(null, this.root);\n    (_a = this.root.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.root);\n  }\n\n  setConnectDisabled(connectDisabled) {\n    this.connectDisabled = connectDisabled;\n  }\n\n  open(options) {\n    this.isOpen = true;\n    this.onCancel = options.onCancel;\n    this.render();\n  }\n\n  close() {\n    this.isOpen = false;\n    this.onCancel = null;\n    this.render();\n  }\n\n  render() {\n    if (!this.root) {\n      return;\n    }\n\n    const subscription = this.extensionUI$.pipe((0, operators_1.first)(enabled => enabled.value !== undefined)) // wait for a valid value before rendering\n    .subscribe(enabled => {\n      if (!this.root) {\n        return;\n      }\n\n      (0, preact_1.render)(enabled.value ? (0, preact_1.h)(TryExtensionLinkDialog_1.TryExtensionLinkDialog, {\n        darkMode: this.darkMode,\n        version: this.version,\n        sessionId: this.sessionId,\n        sessionSecret: this.sessionSecret,\n        walletLinkUrl: this.walletLinkUrl,\n        isOpen: this.isOpen,\n        isConnected: this.isConnected,\n        isParentConnection: this.isParentConnection,\n        onCancel: this.onCancel,\n        connectDisabled: this.connectDisabled\n      }) : (0, preact_1.h)(LinkDialog_1.LinkDialog, {\n        darkMode: this.darkMode,\n        version: this.version,\n        sessionId: this.sessionId,\n        sessionSecret: this.sessionSecret,\n        walletLinkUrl: this.walletLinkUrl,\n        isOpen: this.isOpen,\n        isConnected: this.isConnected,\n        isParentConnection: this.isParentConnection,\n        onCancel: this.onCancel\n      }), this.root);\n    });\n    this.subscriptions.add(subscription);\n  }\n\n}\n\nexports.LinkFlow = LinkFlow;","map":{"version":3,"sources":["/home/johanna/Desktop/ElectricalEthereum/frontend/node_modules/walletlink/dist/components/LinkFlow.js"],"names":["Object","defineProperty","exports","value","LinkFlow","preact_1","require","rxjs_1","operators_1","LinkDialog_1","TryExtensionLinkDialog_1","constructor","options","extensionUI$","BehaviorSubject","subscriptions","Subscription","isConnected","isOpen","onCancel","root","connectDisabled","darkMode","version","sessionId","sessionSecret","walletLinkUrl","isParentConnection","connected$","fetch","then","res","json","enabled","result","desktop","extension_ui","next","catch","err","console","error","attach","el","document","createElement","className","appendChild","render","add","subscribe","v","detach","_a","unsubscribe","parentElement","removeChild","setConnectDisabled","open","close","subscription","pipe","first","undefined","h","TryExtensionLinkDialog","LinkDialog"],"mappings":"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","sourcesContent":["\"use strict\";\n// Copyright (c) 2018-2020 WalletLink.org <https://www.walletlink.org/>\n// Copyright (c) 2018-2020 Coinbase, Inc. <https://www.coinbase.com/>\n// Licensed under the Apache License, version 2.0\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.LinkFlow = void 0;\nconst preact_1 = require(\"preact\");\nconst rxjs_1 = require(\"rxjs\");\nconst operators_1 = require(\"rxjs/operators\");\nconst LinkDialog_1 = require(\"./LinkDialog\");\nconst TryExtensionLinkDialog_1 = require(\"./TryExtensionLinkDialog\");\nclass LinkFlow {\n    constructor(options) {\n        this.extensionUI$ = new rxjs_1.BehaviorSubject({});\n        this.subscriptions = new rxjs_1.Subscription();\n        this.isConnected = false;\n        this.isOpen = false;\n        this.onCancel = null;\n        this.root = null;\n        // if true, hide QR code in LinkFlow (which happens if no jsonRpcUrl is provided)\n        this.connectDisabled = false;\n        this.darkMode = options.darkMode;\n        this.version = options.version;\n        this.sessionId = options.sessionId;\n        this.sessionSecret = options.sessionSecret;\n        this.walletLinkUrl = options.walletLinkUrl;\n        this.isParentConnection = options.isParentConnection;\n        this.connected$ = options.connected$;\n        // Check if extension UI is enabled\n        fetch(\"https://api.wallet.coinbase.com/rpc/v2/getFeatureFlags\")\n            .then(res => res.json())\n            .then(json => {\n            const enabled = json.result.desktop.extension_ui;\n            if (typeof enabled === \"undefined\") {\n                this.extensionUI$.next({ value: false });\n            }\n            else {\n                this.extensionUI$.next({ value: enabled });\n            }\n        })\n            .catch(err => {\n            console.error('Couldn\\'t fetch feature flags - ', err);\n            this.extensionUI$.next({ value: false });\n        });\n    }\n    attach(el) {\n        this.root = document.createElement(\"div\");\n        this.root.className = \"-walletlink-link-flow-root\";\n        el.appendChild(this.root);\n        this.render();\n        this.subscriptions.add(this.connected$.subscribe(v => {\n            if (this.isConnected !== v) {\n                this.isConnected = v;\n                this.render();\n            }\n        }));\n    }\n    detach() {\n        var _a;\n        if (!this.root) {\n            return;\n        }\n        this.subscriptions.unsubscribe();\n        (0, preact_1.render)(null, this.root);\n        (_a = this.root.parentElement) === null || _a === void 0 ? void 0 : _a.removeChild(this.root);\n    }\n    setConnectDisabled(connectDisabled) {\n        this.connectDisabled = connectDisabled;\n    }\n    open(options) {\n        this.isOpen = true;\n        this.onCancel = options.onCancel;\n        this.render();\n    }\n    close() {\n        this.isOpen = false;\n        this.onCancel = null;\n        this.render();\n    }\n    render() {\n        if (!this.root) {\n            return;\n        }\n        const subscription = this.extensionUI$\n            .pipe((0, operators_1.first)(enabled => enabled.value !== undefined)) // wait for a valid value before rendering\n            .subscribe(enabled => {\n            if (!this.root) {\n                return;\n            }\n            (0, preact_1.render)(enabled.value ? ((0, preact_1.h)(TryExtensionLinkDialog_1.TryExtensionLinkDialog, { darkMode: this.darkMode, version: this.version, sessionId: this.sessionId, sessionSecret: this.sessionSecret, walletLinkUrl: this.walletLinkUrl, isOpen: this.isOpen, isConnected: this.isConnected, isParentConnection: this.isParentConnection, onCancel: this.onCancel, connectDisabled: this.connectDisabled })) : ((0, preact_1.h)(LinkDialog_1.LinkDialog, { darkMode: this.darkMode, version: this.version, sessionId: this.sessionId, sessionSecret: this.sessionSecret, walletLinkUrl: this.walletLinkUrl, isOpen: this.isOpen, isConnected: this.isConnected, isParentConnection: this.isParentConnection, onCancel: this.onCancel })), this.root);\n        });\n        this.subscriptions.add(subscription);\n    }\n}\nexports.LinkFlow = LinkFlow;\n"]},"metadata":{},"sourceType":"script"}